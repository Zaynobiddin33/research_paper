{% extends "base.html" %}
{%load static%}

{%block style%}

  <!-- Bootstrap & Font -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f9fafb;
      color: #1f2937;
      padding-top: 72px;
    }

    nav {
      background-color: #fff;
      box-shadow: 0 1px 6px rgba(0,0,0,0.05);
    }

    .navbar-brand {
      font-weight: 700;
      color: #2563eb !important;
      letter-spacing: -0.3px;
    }

    .paper-header {
      background: linear-gradient(180deg, #ffffff 0%, #f3f4f6 100%);
      padding: 80px 20px;
      text-align: center;
    }

    .paper-header h1 {
      font-size: clamp(1.8rem, 4vw, 2.8rem);
      font-weight: 700;
      color: #111827;
    }

    .paper-meta {
      color: #6b7280;
      font-size: 0.95rem;
      margin-top: 8px;
    }

    .paper-card {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      padding: 30px;
      margin-bottom: 40px;
    }

    .badge-status {
      font-size: 0.85rem;
      padding: 6px 12px;
      border-radius: 999px;
    }

    .badge-published { background-color: #d1fae5; color: #065f46; }
    .badge-draft { background-color: #fef3c7; color: #92400e; }
    .badge-review { background-color: #e0e7ff; color: #3730a3; }
    .badge-decline { background-color: #fa153f; color: #f0f0f0; }

    footer {
      text-align: center;
      padding: 40px 0 25px;
      background: #111827;
      color: #e5e7eb;
      font-size: 0.95rem;
    }

    .btn-edit {
      background-color: #2563eb;
      color: #fff;
      border-radius: 999px;
      padding: 10px 22px;
      font-weight: 600;
    }

    .btn-delete {
      background-color: #ef4444;
      color: #fff;
      border-radius: 999px;
      padding: 10px 22px;
      font-weight: 600;
    }

    .btn-edit:hover { background-color: #1e40af; color: #fff; }
    .btn-delete:hover { background-color: #b91c1c; color: #fff; }
  </style>
{%endblock%}

{%block content%}

  <!-- Header -->
  <section class="paper-header">
    <div class="container">
      <h1>{{paper.title}}</h1>
      <div class="paper-meta">
        <span><strong>{{paper.owner.first_name}} {{paper.owner.last_name}}</strong></span> · 
        <span>Yuklangan: {{paper.published_at}}</span> · 
        
        <span>Status: 
          {%if paper.status == 1 %}
              <span class="badge badge-status badge-draft">Tekshirilmagan</span>
            {%elif paper.status == 2%}
            <span class="badge badge-status badge-review">Tekshiruv jarayonida</span>
            {%elif paper.status == 3%}
            <span class="badge badge-status badge-decline">Rad etilgan</span>
            {%elif paper.status == 4%}
            <span class="badge badge-status badge-published">Nashr etilgan</span>
            {%endif%}
        </span>
      </div>
    </div>
  </section>

  <!-- Paper Details -->
  <section class="container my-5">
    <div class="paper-card">
      <h4 class="fw-semibold mb-3">Abstract</h4>
      <p class="text-muted mb-4">
        {{paper.abstract}}
      </p>

      <h4 class="fw-semibold mb-3">Kalit so'zlar</h4>
      <p>{%for key in keywords%}<span class="badge bg-light text-dark me-1">{{key}}</span>{%endfor%}</p>

      <h4 class="fw-semibold mt-4 mb-3">Fayl</h4>
      <a href="{{paper.file.url}}" download="{{ paper.title }}.pdf" class="btn btn-outline-primary rounded-pill">PDF'ni yuklash</a>

      <hr class="my-5" />

      <h4 class="fw-semibold mb-3">Owner Tools</h4>
      <div class="d-flex flex-wrap gap-3">
        <button class="btn btn-edit">Maqolani tahrirlash</button>
        <button type="button" class="btn btn-danger rounded-pill" data-bs-toggle="modal" data-bs-target="#deleteModal">Maqolani o'chirish</button>
      </div>
    </div>
  </section>


  <!-- modal -->
  <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content rounded-3">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">Maqolani o'chirish</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Siz haqiqatan ham ushbu maqolani o'chirmoqchimisiz? Bu amal qaytarib bo'lmaydi.
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary rounded-pill" data-bs-dismiss="modal">Bekor qilish</button>
        <form method="POST" action="{% url 'delete_paper' paper.id %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-danger rounded-pill">O'chirish</button>
        </form>
      </div>
    </div>
  </div>
</div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

{%endblock%}
