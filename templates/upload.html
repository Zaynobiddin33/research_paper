{% extends "base.html" %}
{% load static %}

{% block style %}
    <!-- Bootstrap & Font -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="{% static 'main/css/upload.css' %}">
{% endblock %}

{% block content %}
    <section class="upload-section">
        <div class="container">
            <div class="upload-box">
                <h2>Maqolangizni yuklang</h2>

                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}

                    <!-- Title -->
                    <div class="mb-3">
                        <label for="title" class="form-label">Sarlavha</label>
                        <input name="title" type="text" class="form-control" id="title"
                               minlength="1" maxlength="100"
                               placeholder="Masalan: Sun’iy intellekt orqali tibbiy tashxislashning yangi usullari"
                               required>
                        <div class="form-text">Sarlavha 1–100 belgidan iborat bo‘lishi kerak.</div>
                    </div>

                    <!-- Summary -->
                    <div class="mb-3">
                        <label for="summary" class="form-label">Umumiy fikr (Abstract)</label>
                        <textarea name="abstract" class="form-control" id="summary" rows="4"
                                  minlength="100" maxlength="500"
                                  placeholder="Masalan: Ushbu tadqiqot sun’iy intellekt asosida tibbiy tasvirlar orqali kasalliklarni erta aniqlash samaradorligini baholaydi..."
                                  required></textarea>
                        <div class="form-text">Umumiy fikr 100–500 belgidan iborat bo‘lishi kerak.</div>
                    </div>

                    <!-- Intro with CKEditor -->
                    <div class="mb-3">
                        <label for="editor" class="form-label">Kirish qism</label>
                        <textarea name="intro" class="form-control" id="editor" rows="3"
                                  minlength="100" maxlength="500"
                                  placeholder="Masalan: So‘nggi yillarda raqamli texnologiyalar ta’lim jarayoniga sezilarli ta’sir ko‘rsatmoqda..."
                                  required></textarea>
                        <div class="form-text">Kirish qismi 100–500 belgidan iborat bo‘lishi kerak.</div>
                    </div>

                    <!-- Keywords -->
                    <div class="mb-3">
                        <label for="keywords" class="form-label">Kalit so‘zlar</label>
                        <input type="text" name="keywords" class="form-control" id="keywords"
                               placeholder="AI, Machine Learning, Dasturlash, Python"
                               minlength="10" maxlength="100" required>
                        <div class="form-text">Kalit so‘zlar 10–100 belgidan iborat bo‘lishi kerak.</div>
                    </div>

                    <!-- Category -->
                    <div class="mb-3">
                        <label for="category" class="form-label">Kategoriya</label>
                        <select class="form-select" name="category" id="category" required>
                            {% for category in categories %}
                                <option value="{{ category.name }}">{{ category.name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Optional Organization -->
                    <div class="mb-3">
                        <label for="organization" class="form-label">Muassasa va guruh nomi (ixtiyoriy)</label>
                        <input type="text" name="organization" id="organization" class="form-control"
                               placeholder="Misol: Toshkent Davlat Universiteti"
                               minlength="1" maxlength="120">
                    </div>

                    <!-- Citations with CKEditor -->
                    <div class="mb-3">
                        <label for="citations" class="form-label">Foydalanilgan adabiyotlar</label>
                        <textarea name="citations" id="citations" rows="5"
                                  minlength="100" maxlength="2000"
                                  class="form-control"
                                  placeholder="1. Karimov, I. (2021). Axborot texnologiyalarining rivojlanishi. Toshkent: TDY."
                                  required></textarea>
                        <div class="form-text">100–2000 belgi.</div>
                    </div>

                    <!-- PDF Upload -->
                    <div class="mb-4">
                        <label for="file" class="form-label">PDF yuklash</label>
                        <input name="file" class="form-control" type="file" id="file" accept=".pdf" required>
                        <div class="form-text">Faqat PDF fayllar qabul qilinadi.</div>
                    </div>

                    <!-- Agreement -->
                    <div class="form-check mb-4">
                        <input class="form-check-input" type="checkbox" id="agree" required>
                        <label class="form-check-label" for="agree">
                            Men ushbu maqolaning original ekanligini tasdiqlayman…
                        </label>
                    </div>

                    <div class="text-center">
                        <button type="submit" class="btn btn-primary px-4 py-2">Maqolani joylashtirish</button>
                    </div>

                </form>
            </div>
        </div>
    </section>

    <!-- CKEditor -->
    <script src="https://cdn.ckeditor.com/ckeditor5/41.0.0/classic/ckeditor.js"></script>
    <script>
        ClassicEditor.create(document.querySelector('#editor'))
            .then(editor => console.log("Intro editor ready"))
            .catch(console.error);

        ClassicEditor.create(document.querySelector('#citations'), {
            toolbar: ['numberedList', 'bulletedList', '|', 'undo', 'redo']
        })
            .then(editor => editor.execute('numberedList'))
            .catch(console.error);
    </script>

{% endblock %}
